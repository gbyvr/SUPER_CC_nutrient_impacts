---
title: "SUPER_data_summary"
author: "Gabriella Vieira"
date: "2024-02-02"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


Load packages
```{r}
library(tibble)
library(rlang)
library(tidyverse) #which includes ggplot2
library(tmap) # interactive and static maps
library(sf) # to manage spatial data to make maps
library(tigris) # to import census tract spatial data
library(flextable)
library(ggdark)
library(ggplot2)
library(viridis)
library(RColorBrewer)
library(ggthemes)
library(terra)
library(mapproj)
library(dataRetrieval)
library(httr)
library(jsonlite)
library(neonUtilities)
```


Read data
```{r}
monthprecip_raw <- read.csv("data//PRISM_precip.csv")
watertemp_clean <- read.csv("data//watertemp_clean.csv")
waterqual_clean <- read.csv("data//waterqual.csv")
nitrate <- read.csv("data//nitrate.csv")
Discharge <- read.csv("data//dischargeNeon.csv")
```


#DATA summaries for each variable


#DISCHARGE (NEON)

Variables
```{r}
colnames(Discharge)
```


Add a year column
```{r}
Discharge$Year <- substr(Discharge$endDate, 1, 4)
```

Date range of the data
```{r}
range(waterqual_clean$Year)
```




#NITRATE (NEON)

Variables
```{r}
colnames(nitrate)
```


Add a year column
```{r}
nitrate$Year <- substr(nitrate$startDateTime, 1, 4)
```

Date range of the data
```{r}
range(waterqual_clean$Year)
```


Number of observations per year (all sites)
```{r}
ggplot(nitrate, aes(x = Year)) +
  geom_bar(stat = "count", fill = "pink", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() 
```


Number of observations per site
```{r}
nitrate %>% 
  group_by(siteID) %>% 
  summarise(n_observations = n())
```


Number of observations per year per site
```{r}
ggplot(nitrate, aes(x = Year)) +
  geom_bar(stat = "count", fill = "pink", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() +
  facet_wrap(~siteID, scales = "free_y", ncol = 1)
```


COMO average nitrate value
```{r}
ggplot(nitrate %>% filter(siteID == "COMO"), 
       aes(x = Year, y = surfWaterNitrateMean)) +
  geom_boxplot(fill = "pink", alpha = 0.7) +
  labs(title = "Boxplot of nitrate data for COMO",
       x = "Year",
       y = "Nitrate") +
  theme_minimal()
```

ARIK average nitrate value
```{r}
ggplot(nitrate %>% filter(siteID == "ARIK"), 
       aes(x = Year, y = surfWaterNitrateMean)) +
  geom_boxplot(fill = "pink", alpha = 0.7) +
  labs(title = "Boxplot of nitrate data for ARIK",
       x = "Year",
       y = "Nitrate") +
  theme_minimal()
```


WLOU average nitrate value
```{r}
ggplot(nitrate %>% filter(siteID == "WLOU"), 
       aes(x = Year, y = surfWaterNitrateMean)) +
  geom_boxplot(fill = "pink", alpha = 0.7) +
  labs(title = "Boxplot of nitrate data for WLOU",
       x = "Year",
       y = "Nitrate") +
  theme_minimal()
```





This stuff is good already

#WATER QUALITY (NEON)

Variables
```{r}
colnames(waterqual_clean)
```


Add a year column
```{r}
waterqual_clean$Year <- substr(waterqual_clean$startDateTime, 1, 4)
```

Date range of the data
```{r}
range(waterqual_clean$Year)
```


Number of conductance observations per year (all sites)
```{r}
ggplot(waterqual_clean, aes(x = Year)) +
  geom_bar(stat = "count", fill = "orange", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() 
```


Number of observations per site
```{r}
waterqual_clean %>% 
  group_by(siteID) %>% 
  summarise(n_observations = n())
```


Number of observations per year per site
```{r}
ggplot(waterqual_clean, aes(x = Year)) +
  geom_bar(stat = "count", fill = "orange", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() +
  facet_wrap(~siteID, scales = "free_y", ncol = 1)
```


COMO specific conductance
```{r}
ggplot(waterqual_clean %>% filter(siteID == "COMO"), 
       aes(x = Year, y = specificConductance)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of Conductance data for COMO",
       x = "Year",
       y = "Conductance") +
  theme_minimal()
```

ARIK specific conductance
```{r}
ggplot(waterqual_clean %>% filter(siteID == "ARIK"), 
       aes(x = Year, y = specificConductance)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of Conductance data for ARIK",
       x = "Year",
       y = "Conductance") +
  theme_minimal()
```


WLOU specific conductance
```{r}
ggplot(waterqual_clean %>% filter(siteID == "WLOU"), 
       aes(x = Year, y = specificConductance)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of Conductance data for WLOU",
       x = "Year",
       y = "Conductance") +
  theme_minimal()
```





#WATER TEMPERATURE (NEON)

Variables
```{r}
colnames(watertemp_clean)
```

Add a year column
```{r}
watertemp_clean$Year <- substr(watertemp_clean$startDateTime, 1, 4)
```

Date range of the data
```{r}
range(watertemp_clean$Year)
```

Range of Mean surface temperature
```{r}
range(watertemp_clean$surfWaterTempMean)
```

Range of Min surface temperature
```{r}
range(watertemp_clean$surfWaterTempMinimum)
```

Range of Max surface temperature
```{r}
range(watertemp_clean$surfWaterTempMaximum)
```

Number of observations per year (all sites)
```{r}
ggplot(watertemp_clean, aes(x = Year)) +
  geom_bar(stat = "count", fill = "blue", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() 
```

Number of observations per site
```{r}
watertemp_clean %>% 
  group_by(siteID) %>% 
  summarise(n_observations = n())
```

Number of observations per year per site
```{r}
ggplot(watertemp_clean, aes(x = Year)) +
  geom_bar(stat = "count", fill = "blue", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, color = "black") +
  labs(title = "Number of Observations per Year",
       x = "Year",
       y = "Count") +
  theme_minimal() +
  facet_wrap(~siteID, scales = "free_y", ncol = 1)
```


COMO mean water temp
```{r}
ggplot(watertemp_clean %>% filter(siteID == "COMO"), 
       aes(x = Year, y = surfWaterTempMean)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of surfWaterTempMean for siteID = COMO",
       x = "Year",
       y = "surfWaterTempMean") +
  theme_minimal()
```

ARIK mean water temp
```{r}
ggplot(watertemp_clean %>% filter(siteID == "ARIK"), 
       aes(x = Year, y = surfWaterTempMean)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of surfWaterTempMean for siteID = COMO",
       x = "Year",
       y = "surfWaterTempMean") +
  theme_minimal()
```

WLOU mean water temp
```{r}
ggplot(watertemp_clean %>% filter(siteID == "WLOU"), 
       aes(x = Year, y = surfWaterTempMean)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Boxplot of surfWaterTempMean for siteID = COMO",
       x = "Year",
       y = "surfWaterTempMean") +
  theme_minimal()
```


Average Mean water temperature by year per site
```{r}
ggplot(watertemp_clean, aes(x = Year, y = surfWaterTempMean)) +
  geom_bar(stat = "summary", fun = "mean", fill = "blue", alpha = 0.7) +
  geom_text(stat = "summary", aes(label = round(..y.., 2)), vjust = -0.5, color = "black") +
  labs(title = "Average Water Temperature (C)",
       x = "Year",
       y = "Average Surf Water Temperature") +
  theme_minimal() +
  facet_wrap(~siteID)
```




PRECIPITATION  AND MEAN AIR TEMPERATURE (Grand County)

Variables
```{r}
colnames(monthprecip_raw)
```

Add a year column
```{r}
monthprecip_raw$Year <- substr(monthprecip_raw$Date, 1, 4)
```

Date range of the data (one observation per month)
```{r}
range(monthprecip_raw$Date)
```

Count the number of observations in each year
```{r}
yearsummary_table <- monthprecip_raw %>%
  group_by(Year) %>%
  summarize(Count = n())
print(yearsummary_table)
```

Summarize average precipitation and temperature by year
```{r}
monthprecip_raw %>% 
  group_by(Year) %>% 
  summarise(ppt..mm. = mean(ppt..mm., na.rm = TRUE)) %>% 
  ggplot(aes(x = Year, y = ppt..mm.)) +
  geom_bar(stat = "identity", fill = "orchid", alpha = 0.7) +
  geom_text(aes(label = round(ppt..mm., 2)), vjust = -0.5, color = "black") +
  labs(title = "Average Precipitation by Year",
       x = "Year",
       y = "Average Precipitation (mm)") +
  theme_minimal()

monthprecip_raw %>% 
  group_by(Year) %>% 
  summarise(tmean..degrees.C. = mean(tmean..degrees.C., na.rm = TRUE)) %>% 
  ggplot(aes(x = Year, y = tmean..degrees.C.)) +
  geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
  geom_text(aes(label = round(tmean..degrees.C., 2)), vjust = -0.5, color = "black") +
  labs(title = "Average Air Temp by Year",
       x = "Year",
       y = "Average Temperature (C)") +
  theme_minimal()
```

Precipitation box plot
```{r}
ggplot(monthprecip_raw, aes(x = Year, y = ppt..mm.)) +
  geom_boxplot(fill = "orchid", alpha = 0.7) +
  labs(title = "Distribution of Precipitation by Year",
       x = "Year",
       y = "Precipitation (mm)") +
  theme_minimal()
```

Temperature box plot
```{r}
ggplot(monthprecip_raw, aes(x = Year, y = tmean..degrees.C.)) +
  geom_boxplot(fill = "blue", alpha = 0.7) +
  labs(title = "Distribution of Temperature by Year",
       x = "Year",
       y = "Temperature (C)") +
  theme_minimal()
```

Graph precipitation data (By month, short range to show the seasonal patterns)
```{r}
monthprecip_raw %>% 
  filter(Date >= "2022-01") %>%
  ggplot(aes(x = Date, y = ppt..mm.)) +
  geom_point(color = "black")
```

Graph temperature data (By month, short range to show the seasonal patterns)
```{r}
monthprecip_raw %>% 
  filter(Date >= "2021-01") %>%
  ggplot(aes(x = Date, y = tmean..degrees.C.)) +
  geom_point(color = "black")
```

